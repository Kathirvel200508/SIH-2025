import React, { createContext, useContext, useMemo, useState, ReactNode, useEffect } from "react";

export type SupportedLanguage = "en" | "ta" | "te" | "hi" | "ml" | "kn" | "nagpuri" | "santali";

type Translations = Record<SupportedLanguage, Record<string, string>>;

const translations: Translations = {
  en: {
    reportCta: "Report any civic issues",
    settings: "Settings",
    languages: "Languages",
    helpAbout: "Help & About",
    support: "Support",
    supportEmail: "Support Email",
    close: "Close",
    citizenPortal: "Citizen Portal",
    login: "Login",
    username: "Username",
    password: "Password",
    submitReport: "Submit report",
    loggedInMsg: "Logged in. You can submit a report.",
    title: "Title",
    description: "Description",
    priority: "Priority",
    low: "Low",
    medium: "Medium",
    high: "High",
    attachmentsLabel: "Attachments (images/audio) — max 2 files",
    myReports: "My Reports",
    noReports: "No reports yet",
    location: "Location",
    created: "Created",
    attachments: "Attachments",
    statusHeader: "Status",
    fetchingLocation: "Fetching location…",
    notAvailable: "Not available",
    reportButton: "Report civic issue in your area",
    categoryHeader: "Category",
    cat_sewage: "Sewage",
    cat_electricity: "Electricity",
    cat_waste: "Waste management",
    cat_roads: "Roads",
    cat_transport: "Transport",
    cat_other: "Other",
    status_in_progress: "In progress",
    status_accepted: "Accepted",
    status_rejected: "Rejected",
    status_finished: "Finished",
    leaderboard: "Leaderboard",
    topContributors: "Top Contributors",
    reportsSubmitted: "Reports Submitted",
    rank: "Rank",
    user: "User",
    totalReports: "Total Reports",
    resolvedReports: "Resolved Reports",
    pendingReports: "Pending Reports",
    you: "You",
    currentUser: "Current User",
  },
  ta: {
    reportCta: "சமூகப் பிரச்சினைகளை புகாரளிக்கவும்",
    settings: "அமைப்புகள்",
    languages: "மொழிகள்",
    helpAbout: "உதவி & பற்றி",
    support: "ஆதரவு",
    supportEmail: "ஆதரவு மின்னஞ்சல்",
    close: "மூடு",
    citizenPortal: "குடிமக்கள் போர்டல்",
    login: "உள்நுழை",
    username: "பயனர்பெயர்",
    password: "கடவுச்சொல்",
    submitReport: "அறிக்கையை சமர்ப்பிக்கவும்",
    loggedInMsg: "உள்நுழைந்துள்ளீர்கள். நீங்கள் புகார் அளிக்கலாம்.",
    title: "தலைப்பு",
    description: "விளக்கம்",
    priority: "முன்னுரிமை",
    low: "குறைந்த",
    medium: "நடுத்தர",
    high: "அதிக",
    attachmentsLabel: "இணைப்புகள் (படங்கள்/ஆடியோ) — அதிகபட்சம் 2",
    myReports: "என் புகார்கள்",
    noReports: "இதுவரை புகார்கள் இல்லை",
    location: "இடம்",
    created: "உருவாக்கப்பட்டது",
    attachments: "இணைப்புகள்",
    statusHeader: "நிலையில்",
    fetchingLocation: "இடம் பெறப்படுகிறது…",
    notAvailable: "கிடைக்கவில்லை",
    reportButton: "உங்கள் பகுதியில் குடிமை பிரச்சினையை புகாரளிக்கவும்",
    categoryHeader: "வகை",
    cat_sewage: "கழிவு நீர்",
    cat_electricity: "மின்சாரம்",
    cat_waste: "கழிவு மேலாண்மை",
    cat_roads: "சாலைகள்",
    cat_transport: "போக்குவரத்து",
    cat_other: "மற்றவை",
    status_in_progress: "நடைமுறையில்",
    status_accepted: "ஏற்றுக்கொள்ளப்பட்டது",
    status_rejected: "நிராகரிக்கப்பட்டது",
    status_finished: "முடிந்தது",
    leaderboard: "முன்னணி பட்டியல்",
    topContributors: "முன்னணி பங்களிப்பாளர்கள்",
    reportsSubmitted: "சமர்ப்பிக்கப்பட்ட புகார்கள்",
    rank: "தரவரிசை",
    user: "பயனர்",
    totalReports: "மொத்த புகார்கள்",
    resolvedReports: "தீர்க்கப்பட்ட புகார்கள்",
    pendingReports: "நிலுவையில் உள்ள புகார்கள்",
    you: "நீங்கள்",
    currentUser: "தற்போதைய பயனர்",
  },
  te: {
    reportCta: "పౌర సమస్యలను నివేదించండి",
    settings: "సెట్టింగ్స్",
    languages: "భాషలు",
    helpAbout: "సహాయం & గురించి",
    support: "సహాయం",
    supportEmail: "మద్దతు ఇమెయిల్",
    close: "మూసివేయి",
    citizenPortal: "పౌరుల పోర్టల్",
    login: "ప్రవేశించండి",
    username: "వాడుకరి పేరు",
    password: "పాస్వర్డ్",
    submitReport: "రిపోర్ట్ సమర్పించండి",
    loggedInMsg: "లాగిన్ అయ్యారు. మీరు రిపోర్ట్ సమర్పించవచ్చు.",
    title: "శీర్షిక",
    description: "వివరణ",
    priority: "ప్రాముఖ్యత",
    low: "తక్కువ",
    medium: "మధ్యస్థ",
    high: "అధిక",
    attachmentsLabel: "జతలు (చిత్రాలు/ఆడియో) — గరిష్టం 2",
    myReports: "నా నివేదికలు",
    noReports: "ఇప్పటివరకు నివేదికలు లేవు",
    location: "స్థానం",
    created: "సృష్టించబడింది",
    attachments: "జతలు",
    statusHeader: "స్థితి",
    fetchingLocation: "స్థానాన్ని తెచ్చుకుంటున్నాం…",
    notAvailable: "లభ్యం కాదు",
    reportButton: "మీ ప్రాంతంలో పౌర సమస్యను నివేదించండి",
    categoryHeader: "వర్గం",
    cat_sewage: "కాలువ",
    cat_electricity: "విద్యుత్",
    cat_waste: "వ్యర్థ నిర్వహణ",
    cat_roads: "రోడ్లు",
    cat_transport: "రవాణా",
    cat_other: "ఇతర",
    status_in_progress: "ప్రగతిలో",
    status_accepted: "ఆమోదించబడింది",
    status_rejected: "తిరస్కరించబడింది",
    status_finished: "పూర్తయ్యింది",
    leaderboard: "ముందున్న పట్టిక",
    topContributors: "ముందున్న సహకారులు",
    reportsSubmitted: "సమర్పించిన నివేదికలు",
    rank: "ర్యాంక్",
    user: "వాడుకరి",
    totalReports: "మొత్తం నివేదికలు",
    resolvedReports: "పరిష్కరించిన నివేదికలు",
    pendingReports: "వేచి ఉన్న నివేదికలు",
    you: "మీరు",
    currentUser: "ప్రస్తుత వాడుకరి",
  },
  hi: {
    reportCta: "किसी भी नागरिक समस्या की रिपोर्ट करें",
    settings: "सेटिंग्स",
    languages: "भाषाएँ",
    helpAbout: "सहायता और जानकारी",
    support: "सहायता",
    supportEmail: "सहायता ईमेल",
    close: "बंद करें",
    citizenPortal: "नागरिक पोर्टल",
    login: "लॉगिन",
    username: "उपयोगकर्ता नाम",
    password: "पासवर्ड",
    submitReport: "रिपोर्ट जमा करें",
    loggedInMsg: "लॉगिन हो गया। आप रिपोर्ट जमा कर सकते हैं।",
    title: "शीर्षक",
    description: "विवरण",
    priority: "प्राथमिकता",
    low: "कम",
    medium: "मध्यम",
    high: "उच्च",
    attachmentsLabel: "संलग्नक (चित्र/ऑडियो) — अधिकतम 2",
    myReports: "मेरी रिपोर्टें",
    noReports: "अभी तक कोई रिपोर्ट नहीं",
    location: "स्थान",
    created: "बनाया गया",
    attachments: "संलग्नक",
    statusHeader: "स्थिति",
    fetchingLocation: "स्थान प्राप्त किया जा रहा है…",
    notAvailable: "उपलब्ध नहीं",
    reportButton: "अपने क्षेत्र में नागरिक समस्या की रिपोर्ट करें",
    categoryHeader: "श्रेणी",
    cat_sewage: "सीवेज",
    cat_electricity: "बिजली",
    cat_waste: "कचरा प्रबंधन",
    cat_roads: "सड़कें",
    cat_transport: "परिवहन",
    cat_other: "अन्य",
    status_in_progress: "प्रगति पर",
    status_accepted: "स्वीकृत",
    status_rejected: "अस्वीकृत",
    status_finished: "समाप्त",
    leaderboard: "लीडरबोर्ड",
    topContributors: "शीर्ष योगदानकर्ता",
    reportsSubmitted: "प्रस्तुत रिपोर्टें",
    rank: "रैंक",
    user: "उपयोगकर्ता",
    totalReports: "कुल रिपोर्टें",
    resolvedReports: "हल की गई रिपोर्टें",
    pendingReports: "लंबित रिपोर्टें",
    you: "आप",
    currentUser: "वर्तमान उपयोगकर्ता",
  },
  ml: {
    reportCta: "പൗര പ്രശ്നങ്ങൾ റിപ്പോർട്ട് ചെയ്യുക",
    settings: "ക്രമീകരണങ്ങൾ",
    languages: "ഭാഷകൾ",
    helpAbout: "സഹായം & കുറിച്ച്",
    support: "സഹായം",
    supportEmail: "സപ്പോർട്ട് ഇമെയിൽ",
    close: "അടയ്ക്കുക",
    citizenPortal: "കൗമാര പോർട്ടൽ",
    login: "ലോഗിൻ",
    username: "ഉപയോക്തൃനാമം",
    password: "പാസ്വേഡ്",
    submitReport: "റിപ്പോർട്ട് സമർപ്പിക്കുക",
    loggedInMsg: "ലോഗിൻ ചെയ്തു. നിങ്ങൾക്ക് റിപ്പോർട്ട് സമർപ്പിക്കാം.",
    title: "ശീർഷകം",
    description: "വിവരണം",
    priority: "പ്രാധാന്യം",
    low: "കുറവ്",
    medium: "ഇടത്തരം",
    high: "ഉയർന്ന്",
    attachmentsLabel: "അറ്റാച്ച്മെന്റുകൾ (ചിത്രം/ഓഡിയോ) — പരമാവധി 2",
    myReports: "എന്റെ റിപ്പോർട്ടുകൾ",
    noReports: "ഇനിയും റിപ്പോർട്ടുകൾ ഇല്ല",
    location: "സ്ഥലം",
    created: "സൃഷ്ടിച്ചത്",
    attachments: "അറ്റാച്ച്മെന്റുകൾ",
    statusHeader: "സ്ഥിതി",
    fetchingLocation: "സ്ഥാനം ശേഖരിക്കുന്നു…",
    notAvailable: "ലഭ്യമല്ല",
    reportButton: "നിങ്ങളുടെ പ്രദേശത്തെ പൗര പ്രശ്നം റിപ്പോർട്ട് ചെയ്യുക",
    categoryHeader: "വിഭാഗം",
    cat_sewage: "മലിനജലം",
    cat_electricity: "വൈദ്യുതി",
    cat_waste: "മാലിന്യ നിയന്ത്രണം",
    cat_roads: "റോഡുകൾ",
    cat_transport: "ഗതാഗതം",
    cat_other: "മറ്റ്",
    status_in_progress: "പുരോഗതിയിൽ",
    status_accepted: "അംഗീകരിച്ചു",
    status_rejected: "നിരസിച്ചു",
    status_finished: "പൂർത്തിയായി",
    leaderboard: "ലീഡർബോർഡ്",
    topContributors: "മുൻനിര സംഭാവകർ",
    reportsSubmitted: "സമർപ്പിച്ച റിപ്പോർട്ടുകൾ",
    rank: "റാങ്ക്",
    user: "ഉപയോക്താവ്",
    totalReports: "മൊത്തം റിപ്പോർട്ടുകൾ",
    resolvedReports: "പരിഹരിച്ച റിപ്പോർട്ടുകൾ",
    pendingReports: "തീരുമാനിക്കാത്ത റിപ്പോർട്ടുകൾ",
    you: "നിങ്ങൾ",
    currentUser: "നിലവിലെ ഉപയോക്താവ്",
  },
  kn: {
    reportCta: "ಯಾವುದೇ ನಾಗರಿಕ ಸಮಸ್ಯೆಯನ್ನು ವರದಿ ಮಾಡಿ",
    settings: "ಸೆಟ್ಟಿಂಗ್‍ಗಳು",
    languages: "ಭಾಷೆಗಳು",
    helpAbout: "ಸಹಾಯ ಮತ್ತು ಬಗ್ಗೆ",
    support: "ಬೆಂಬಲ",
    supportEmail: "ಬೆಂಬಲ ಇಮೇಲ್",
    close: "ಮುಚ್ಚಿ",
    citizenPortal: "ನಾಗರಿಕ ಪೋರ್ಟಲ್",
    login: "ಲಾಗಿನ್",
    username: "ಬಳಕೆದಾರ ಹೆಸರು",
    password: "ಪಾಸ್ವರ್ಡ್",
    submitReport: "ವರದಿ ಸಲ್ಲಿಸಿ",
    loggedInMsg: "ಲಾಗಿನ್ ಆಗಿದ್ದೀರಿ. ನೀವು ವರದಿ ಸಲ್ಲಿಸಬಹುದು.",
    title: "ಶೀರ್ಷಿಕೆ",
    description: "ವಿವರಣೆ",
    priority: "ಆದ್ಯತೆ",
    low: "ಕಡಿಮೆ",
    medium: "ಮಧ್ಯಮ",
    high: "ಹೆಚ್ಚು",
    attachmentsLabel: "ಲಗತ್ತುಗಳು (ಚಿತ್ರ/ಆಡಿಯೊ) — ಗರಿಷ್ಠ 2",
    myReports: "ನನ್ನ ವರದಿಗಳು",
    noReports: "ಇನ್ನೂ ಯಾವುದೇ ವರದಿಗಳು ಇಲ್ಲ",
    location: "ಸ್ಥಳ",
    created: "ರಚಿಸಲಾಗಿದೆ",
    attachments: "ಲಗತ್ತುಗಳು",
    statusHeader: "ಸ್ಥಿತಿ",
    fetchingLocation: "ಸ್ಥಳವನ್ನು ಪಡೆಯಲಾಗುತ್ತಿದೆ…",
    notAvailable: "ಲಭ್ಯವಿಲ್ಲ",
    reportButton: "ನಿಮ್ಮ ಪ್ರದೇಶದಲ್ಲಿನ ನಾಗರಿಕ ಸಮಸ್ಯೆಯನ್ನು ವರದಿ ಮಾಡಿ",
    categoryHeader: "ವರ್ಗ",
    cat_sewage: "ಮಲಿನಜಲ",
    cat_electricity: "ವಿದ್ಯುತ್",
    cat_waste: "ಅನಾಚರಣೆ ನಿರ್ವಹಣೆ",
    cat_roads: "ರಸ್ತೆಗಳು",
    cat_transport: "ಸಾರಿಗೆ",
    cat_other: "ಇತರೆ",
    status_in_progress: "ಪ್ರಗತಿಯಲ್ಲಿ",
    status_accepted: "ಅಂಗೀಕರಿಸಲಾಗಿದೆ",
    status_rejected: "ತಿರಸ್ಕರಿಸಲಾಗಿದೆ",
    status_finished: "ಪೂರ್ಣಗೊಂಡಿದೆ",
    leaderboard: "ಲೀಡರ್‌ಬೋರ್ಡ್",
    topContributors: "ಮುಂಚೂಣಿ ಕೊಡುಗೆದಾರರು",
    reportsSubmitted: "ಸಲ್ಲಿಸಿದ ವರದಿಗಳು",
    rank: "ಶ್ರೇಣಿ",
    user: "ಬಳಕೆದಾರ",
    totalReports: "ಒಟ್ಟು ವರದಿಗಳು",
    resolvedReports: "ಪರಿಹರಿಸಿದ ವರದಿಗಳು",
    pendingReports: "ಬಾಕಿ ವರದಿಗಳು",
    you: "ನೀವು",
    currentUser: "ಪ್ರಸ್ತುತ ಬಳಕೆದಾರ",
  },
  nagpuri: {
    reportCta: "कोनो नागरिंक समस्या बताव",
    settings: "सेटिंग",
    languages: "भाषा",
    helpAbout: "मदत आ बारे",
    support: "सहायता",
    supportEmail: "सहायता ईमेल",
    close: "बंद",
    citizenPortal: "नागरिक पोर्टल",
    login: "लॉगिन",
    username: "उपयोगकर्ता नाम",
    password: "पासवर्ड",
    submitReport: "रिपोर्ट भेजव",
    loggedInMsg: "लॉगिन हो गेल. आप रिपोर्ट भेज सकथें",
    title: "शीर्षक",
    description: "विवरण",
    priority: "प्राथमिकता",
    low: "कम",
    medium: "मध्यम",
    high: "जोर",
    attachmentsLabel: "जुड़ल फाइल (फोटो/आवाज) — अधिकतम 2",
    myReports: "हमर रिपोर्ट",
    noReports: "अखनी ले रिपोर्ट नै छे",
    location: "जगह",
    created: "बनवल गेल",
    attachments: "जुड़ल फाइल",
    statusHeader: "स्थिति",
    fetchingLocation: "जगह मिल रहल…",
    notAvailable: "उपलब्ध नै",
    reportButton: "अपन इलाका के समस्या बताव",
    categoryHeader: "श्रेणी",
    cat_sewage: "नाला/सीवरेज",
    cat_electricity: "बिजली",
    cat_waste: "कचराप्रबंधन",
    cat_roads: "सड़क",
    cat_transport: "आवागमन",
    cat_other: "दोसर",
    status_in_progress: "काम मा",
    status_accepted: "मानल गेल",
    status_rejected: "खारिज",
    status_finished: "पूरा",
    leaderboard: "लीडरबोर्ड",
    topContributors: "शीर्ष सहयोगी",
    reportsSubmitted: "जमाक रिपोर्ट",
    rank: "रैंक",
    user: "यूजर",
    totalReports: "कुल रिपोर्ट",
    resolvedReports: "हल रिपोर्ट",
    pendingReports: "बाकी रिपोर्ट",
    you: "आप",
    currentUser: "वर्तमान यूजर",
  },
  santali: {
    reportCta: "ᱚᱛᱟᱨ ᱠᱚ ᱠᱷᱚᱞ ᱨᱮᱯᱚᱨᱛ ᱢᱮ",
    settings: "ᱥᱟᱡᱟᱣ",
    languages: "ᱵᱟᱹᱪᱤ",
    helpAbout: "ᱦᱮᱞᱤᱯ ᱟᱨ ᱵᱟᱹᱲᱛᱤ",
    support: "ᱥᱟᱹᱛᱛᱚᱨᱛ",
    supportEmail: "ᱥᱟᱹᱛᱛᱚᱨᱛ ᱤᱢᱮᱞ",
    close: "ᱵᱟᱹᱰᱤ",
    citizenPortal: "ᱠᱤᱡᱤᱱ ᱯᱚᱨᱛᱚᱞ",
    login: "ᱞᱟᱹᱜᱤᱱ",
    username: "ᱩᱡᱟᱹᱨ ᱧᱩᱛᱩᱢ",
    password: "ᱯᱟᱥᱯᱚᱨᱰ",
    submitReport: "ᱨᱮᱯᱚᱨᱛ ᱥᱩᱢᱤᱵᱤᱴ ᱢᱮ",
    loggedInMsg: "ᱞᱟᱹᱜᱤᱱ ᱮᱱᱟ. ᱟᱞᱚᱢ ᱨᱮᱯᱚᱨᱛ ᱥᱩᱢᱤᱵᱤᱴ ᱢᱮ",
    title: "ᱛᱤᱞᱚ",
    description: "ᱵᱟᱵᱚᱛ",
    priority: "ᱯᱨᱟᱭᱚᱨᱤᱴᱤ",
    low: "ᱞᱟᱹᱜᱤᱫ",
    medium: "ᱢᱮᱰᱤᱭᱚᱢ",
    high: "ᱦᱟᱭ",
    attachmentsLabel: "ᱟᱛᱮᱭᱟᱜ (ᱚᱞᱟ/ᱟᱭᱰᱤᱭᱚ) — 2 ᱨᱟᱢ",
    myReports: "ᱟᱢᱟᱜ ᱨᱮᱯᱚᱨᱛ",
    noReports: "ᱛᱮᱭᱟᱱ ᱨᱮᱯᱚᱨᱛ ᱵᱟᱝ ᱦᱟᱛᱟᱣ",
    location: "ᱚᱱᱚᱞ",
    created: "ᱪᱮᱞᱟᱣ ᱮᱱᱟ",
    attachments: "ᱟᱛᱮᱭᱟᱜ",
    statusHeader: "ᱥᱴᱟᱴᱩᱥ",
    fetchingLocation: "ᱚᱱᱚᱞ ᱟᱞᱚ ᱠᱟᱱᱟ…",
    notAvailable: "ᱞᱟᱫᱮᱨᱟᱣ ᱵᱟᱝ",
    reportButton: "ᱵᱚᱸᱫ ᱥᱟᱱᱛᱟᱞ ᱥᱟᱠᱟᱱᱟ ᱨᱮᱯᱚᱨᱛ ᱢᱮ",
    categoryHeader: "ᱠᱮᱛᱮᱨᱤ",
    cat_sewage: "ᱥᱤᱣᱟᱡ",
    cat_electricity: "ᱤᱞᱮᱠᱴᱨᱤᱥᱤᱴᱤ",
    cat_waste: "ᱣᱮᱥᱴ ᱢᱮᱞᱮᱞᱟᱱᱡᱮᱱᱴ",
    cat_roads: "ᱨᱚᱫ",
    cat_transport: "ᱛᱟᱹᱨᱥᱯᱚᱱᱴ",
    cat_other: "ᱮᱴᱚᱛ",
    status_in_progress: "ᱯᱨᱚᱜᱚᱥ",
    status_accepted: "ᱡᱚᱦᱚᱨ ᱮᱱᱟ",
    status_rejected: "ᱟᱹᱨᱫᱤᱡᱽ",
    status_finished: "ᱢᱩᱞᱟᱹᱭ",
    leaderboard: "ᱞᱤᱰᱚᱨᱵᱚᱨᱰ",
    topContributors: "ᱢᱟᱦᱟᱸ ᱠᱚ ᱦᱟᱸᱱᱤᱡ ᱠᱚ",
    reportsSubmitted: "ᱥᱩᱢᱤᱵᱤᱴ ᱨᱮᱯᱚᱨᱛ",
    rank: "ᱨᱮᱝᱠ",
    user: "ᱩᱡᱟᱹᱨ",
    totalReports: "ᱢᱩᱞ ᱨᱮᱯᱚᱨᱛ",
    resolvedReports: "ᱥᱟᱨᱛᱤᱭᱟ ᱨᱮᱯᱚᱨᱛ",
    pendingReports: "ᱵᱟᱝ ᱞᱟᱫᱮᱨᱟᱣ ᱨᱮᱯᱚᱨᱛ",
    you: "ᱟᱢ",
    currentUser: "ᱱᱤᱡᱚᱛ ᱩᱡᱟᱹᱨ",
  },
};

type LanguageContextValue = {
  lang: SupportedLanguage;
  setLang: (l: SupportedLanguage) => void;
  t: (key: keyof typeof translations["en"]) => string;
};

const LanguageContext = createContext<LanguageContextValue | undefined>(undefined);

export function LanguageProvider({ children }: { children: ReactNode }) {
  const [lang, setLang] = useState<SupportedLanguage>("en");

  useEffect(() => {
    const saved = typeof window !== "undefined" ? localStorage.getItem("citizen_lang") : null;
    if (saved && ["en","ta","te","hi","ml","kn","nagpuri","santali"].includes(saved)) setLang(saved as SupportedLanguage);
  }, []);

  useEffect(() => {
    if (typeof document !== "undefined") {
      document.documentElement.lang = lang;
      document.documentElement.dir = "ltr";
    }
  }, [lang]);

  const value = useMemo<LanguageContextValue>(() => ({
    lang,
    setLang: (l) => {
      setLang(l);
      if (typeof window !== "undefined") localStorage.setItem("citizen_lang", l);
    },
    t: (key) => translations[lang][key],
  }), [lang]);

  return <LanguageContext.Provider value={value}>{children}</LanguageContext.Provider>;
}

export function useLanguage() {
  const ctx = useContext(LanguageContext);
  if (!ctx) throw new Error("useLanguage must be used within LanguageProvider");
  return ctx;
}


